<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>MySQLi extension basic examples</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mysqli.examples.html">« Examples</a></li>
      <li style="float: right;"><a href="class.mysqli.html">mysqli »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="mysqli.examples.html">Examples</a></li>
    <li>MySQLi extension basic examples</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mysqli.examples-basic" class="section">
  <h2 class="title">MySQLi extension basic examples</h2>
  <p class="para">
   This example shows how to connect, execute a query, use basic
   error handling, print resulting rows, and disconnect from a MySQL database.
  </p>
  <p class="para">
   This example uses the freely available Sakila database that
   can be downloaded from <a href="http://dev.mysql.com/doc/sakila/en/index.html" class="link external">&raquo;&nbsp;dev.mysql.com,
   as described here</a>. To get this example to work, (a) install sakila 
   and (b) modify the connection variables (host, your_user, your_pass).
  </p>
  <div class="example" id="example-1651">
   <p><strong>Example #1 MySQLi extension overview example</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Let's&nbsp;pass&nbsp;in&nbsp;a&nbsp;$_GET&nbsp;variable&nbsp;to&nbsp;our&nbsp;example,&nbsp;in&nbsp;this&nbsp;case<br />//&nbsp;it's&nbsp;aid&nbsp;for&nbsp;actor_id&nbsp;in&nbsp;our&nbsp;Sakila&nbsp;database.&nbsp;Let's&nbsp;make&nbsp;it<br />//&nbsp;default&nbsp;to&nbsp;1,&nbsp;and&nbsp;cast&nbsp;it&nbsp;to&nbsp;an&nbsp;integer&nbsp;as&nbsp;to&nbsp;avoid&nbsp;SQL&nbsp;injection<br />//&nbsp;and/or&nbsp;related&nbsp;security&nbsp;problems.&nbsp;Handling&nbsp;all&nbsp;of&nbsp;this&nbsp;goes&nbsp;beyond<br />//&nbsp;the&nbsp;scope&nbsp;of&nbsp;this&nbsp;simple&nbsp;example.&nbsp;Example:<br />//&nbsp;&nbsp;&nbsp;http://example.org/script.php?aid=42<br /></span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'aid'</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">is_numeric</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'aid'</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$aid&nbsp;</span><span style="color: #007700">=&nbsp;(int)&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'aid'</span><span style="color: #007700">];<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$aid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Connecting&nbsp;to&nbsp;and&nbsp;selecting&nbsp;a&nbsp;MySQL&nbsp;database&nbsp;named&nbsp;sakila<br />//&nbsp;Hostname:&nbsp;127.0.0.1,&nbsp;username:&nbsp;your_user,&nbsp;password:&nbsp;your_pass,&nbsp;db:&nbsp;sakila<br /></span><span style="color: #0000BB">$mysqli&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">'127.0.0.1'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'your_user'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'your_pass'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sakila'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Oh&nbsp;no!&nbsp;A&nbsp;connect_errno&nbsp;exists&nbsp;so&nbsp;the&nbsp;connection&nbsp;attempt&nbsp;failed!<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_errno</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;The&nbsp;connection&nbsp;failed.&nbsp;What&nbsp;do&nbsp;you&nbsp;want&nbsp;to&nbsp;do?&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;You&nbsp;could&nbsp;contact&nbsp;yourself&nbsp;(email?),&nbsp;log&nbsp;the&nbsp;error,&nbsp;show&nbsp;a&nbsp;nice&nbsp;page,&nbsp;etc.<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;You&nbsp;do&nbsp;not&nbsp;want&nbsp;to&nbsp;reveal&nbsp;sensitive&nbsp;information<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Let's&nbsp;try&nbsp;this:<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Sorry,&nbsp;this&nbsp;website&nbsp;is&nbsp;experiencing&nbsp;problems."</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Something&nbsp;you&nbsp;should&nbsp;not&nbsp;do&nbsp;on&nbsp;a&nbsp;public&nbsp;site,&nbsp;but&nbsp;this&nbsp;example&nbsp;will&nbsp;show&nbsp;you<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;anyways,&nbsp;is&nbsp;print&nbsp;out&nbsp;MySQL&nbsp;error&nbsp;related&nbsp;information&nbsp;--&nbsp;you&nbsp;might&nbsp;log&nbsp;this<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Error:&nbsp;Failed&nbsp;to&nbsp;make&nbsp;a&nbsp;MySQL&nbsp;connection,&nbsp;here&nbsp;is&nbsp;why:&nbsp;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Errno:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_errno&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Error:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_error&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;You&nbsp;might&nbsp;want&nbsp;to&nbsp;show&nbsp;them&nbsp;something&nbsp;nice,&nbsp;but&nbsp;we&nbsp;will&nbsp;simply&nbsp;exit<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">exit;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Perform&nbsp;an&nbsp;SQL&nbsp;query<br /></span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;actor_id,&nbsp;first_name,&nbsp;last_name&nbsp;FROM&nbsp;actor&nbsp;WHERE&nbsp;actor_id&nbsp;=&nbsp;</span><span style="color: #0000BB">$aid</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />if&nbsp;(!</span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Oh&nbsp;no!&nbsp;The&nbsp;query&nbsp;failed.&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Sorry,&nbsp;the&nbsp;website&nbsp;is&nbsp;experiencing&nbsp;problems."</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Again,&nbsp;do&nbsp;not&nbsp;do&nbsp;this&nbsp;on&nbsp;a&nbsp;public&nbsp;site,&nbsp;but&nbsp;we'll&nbsp;show&nbsp;you&nbsp;how<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;to&nbsp;get&nbsp;the&nbsp;error&nbsp;information<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Error:&nbsp;Our&nbsp;query&nbsp;failed&nbsp;to&nbsp;execute&nbsp;and&nbsp;here&nbsp;is&nbsp;why:&nbsp;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Query:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Errno:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errno&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Error:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">error&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Phew,&nbsp;we&nbsp;made&nbsp;it.&nbsp;We&nbsp;know&nbsp;our&nbsp;MySQL&nbsp;connection&nbsp;and&nbsp;query&nbsp;<br />//&nbsp;succeeded,&nbsp;but&nbsp;do&nbsp;we&nbsp;have&nbsp;a&nbsp;result?<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Oh,&nbsp;no&nbsp;rows!&nbsp;Sometimes&nbsp;that's&nbsp;expected&nbsp;and&nbsp;okay,&nbsp;sometimes<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;it&nbsp;is&nbsp;not.&nbsp;You&nbsp;decide.&nbsp;In&nbsp;this&nbsp;case,&nbsp;maybe&nbsp;actor_id&nbsp;was&nbsp;too<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;large?&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"We&nbsp;could&nbsp;not&nbsp;find&nbsp;a&nbsp;match&nbsp;for&nbsp;ID&nbsp;</span><span style="color: #0000BB">$aid</span><span style="color: #DD0000">,&nbsp;sorry&nbsp;about&nbsp;that.&nbsp;Please&nbsp;try&nbsp;again."</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Now,&nbsp;we&nbsp;know&nbsp;only&nbsp;one&nbsp;result&nbsp;will&nbsp;exist&nbsp;in&nbsp;this&nbsp;example&nbsp;so&nbsp;let's&nbsp;<br />//&nbsp;fetch&nbsp;it&nbsp;into&nbsp;an&nbsp;associated&nbsp;array&nbsp;where&nbsp;the&nbsp;array's&nbsp;keys&nbsp;are&nbsp;the&nbsp;<br />//&nbsp;table's&nbsp;column&nbsp;names<br /></span><span style="color: #0000BB">$actor&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">();<br />echo&nbsp;</span><span style="color: #DD0000">"Sometimes&nbsp;I&nbsp;see&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">'first_name'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">'last_name'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"&nbsp;on&nbsp;TV."</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;Now,&nbsp;let's&nbsp;fetch&nbsp;five&nbsp;random&nbsp;actors&nbsp;and&nbsp;output&nbsp;their&nbsp;names&nbsp;to&nbsp;a&nbsp;list.<br />//&nbsp;We'll&nbsp;add&nbsp;less&nbsp;error&nbsp;handling&nbsp;here&nbsp;as&nbsp;you&nbsp;can&nbsp;do&nbsp;that&nbsp;on&nbsp;your&nbsp;own&nbsp;now<br /></span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;actor_id,&nbsp;first_name,&nbsp;last_name&nbsp;FROM&nbsp;actor&nbsp;ORDER&nbsp;BY&nbsp;rand()&nbsp;LIMIT&nbsp;5"</span><span style="color: #007700">;<br />if&nbsp;(!</span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Sorry,&nbsp;the&nbsp;website&nbsp;is&nbsp;experiencing&nbsp;problems."</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Print&nbsp;our&nbsp;5&nbsp;random&nbsp;actors&nbsp;in&nbsp;a&nbsp;list,&nbsp;and&nbsp;link&nbsp;to&nbsp;each&nbsp;actor<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"&lt;ul&gt;\n"</span><span style="color: #007700">;<br />while&nbsp;(</span><span style="color: #0000BB">$actor&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">())&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;li&gt;&lt;a&nbsp;href='"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'SCRIPT_FILENAME'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"?aid="&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">'actor_id'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"'&gt;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">'first_name'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">'&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">'last_name'</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;/a&gt;&lt;/li&gt;\n"</span><span style="color: #007700">;<br />}<br />echo&nbsp;</span><span style="color: #DD0000">"&lt;/ul&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;The&nbsp;script&nbsp;will&nbsp;automatically&nbsp;free&nbsp;the&nbsp;result&nbsp;and&nbsp;close&nbsp;the&nbsp;MySQL<br />//&nbsp;connection&nbsp;when&nbsp;it&nbsp;exits,&nbsp;but&nbsp;let's&nbsp;just&nbsp;do&nbsp;it&nbsp;anyways<br /></span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">free</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">close</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div></div></div></body></html>